# Redis Configuration for t3.small/medium EC2 instances
# Optimized for 2GB-4GB RAM environments

# Memory Management
# For t3.small (2GB RAM): Use 512mb
# For t3.medium (4GB RAM): Use 1gb
maxmemory 512mb
maxmemory-policy allkeys-lru

# Persistence Configuration
# Balance between performance and data safety
save 900 1      # Save after 900 seconds if at least 1 key changed
save 300 10     # Save after 300 seconds if at least 10 keys changed
save 60 10000   # Save after 60 seconds if at least 10000 keys changed

# Disable RDB compression to save CPU (trade disk space for performance)
rdbcompression no

# Performance Settings
tcp-keepalive 300
timeout 300

# Disable slower operations that could impact performance
slowlog-log-slower-than 10000

# Security Settings
bind 127.0.0.1
protected-mode yes

# Logging
loglevel notice

# Background save configuration
stop-writes-on-bgsave-error yes

# Memory usage reporting
maxmemory-samples 5